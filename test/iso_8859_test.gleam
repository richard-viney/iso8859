import gleam/list
import gleeunit
import gleeunit/should
import iso_8859

pub fn main() {
  gleeunit.main()
}

pub fn decode_bytes_test() {
  let test_decode = fn(
    bits: BitArray,
    encoding: iso_8859.Encoding,
    expected_result: String,
  ) {
    iso_8859.decode_bytes(bits, encoding)
    |> should.equal(expected_result)
  }

  test_decode(<<0x70, 0x62, 0x41, 0xD8>>, iso_8859.Part1, "pbAØ")
  test_decode(<<0xEC, 0xE0, 0x48, 0xB4>>, iso_8859.Part5, "ьрHД")
  test_decode(<<0xEC, 0xE0, 0x48, 0xB4>>, iso_8859.Part13, "ģąH“")
  test_decode(<<0xB4, 0xEC, 0xE0>>, iso_8859.Part5, "Дьр")
}

/// Tests decoding the upper 96 characters of every encoding against the
/// character tables below.
///
pub fn decode_upper_characters_test() {
  let test_decode = fn(encoding: iso_8859.Encoding, upper_chars: List(String)) {
    list.range(0xA0, 0xFF)
    |> list.map(fn(b) { iso_8859.decode_bytes(<<b>>, encoding) })
    |> should.equal(upper_chars)
  }

  test_decode(iso_8859.Part1, part_1_upper_chars)
  test_decode(iso_8859.Part2, part_2_upper_chars)
  test_decode(iso_8859.Part3, part_3_upper_chars)
  test_decode(iso_8859.Part4, part_4_upper_chars)
  test_decode(iso_8859.Part5, part_5_upper_chars)
  test_decode(iso_8859.Part6, part_6_upper_chars)
  test_decode(iso_8859.Part7, part_7_upper_chars)
  test_decode(iso_8859.Part8, part_8_upper_chars)
  test_decode(iso_8859.Part9, part_9_upper_chars)
  test_decode(iso_8859.Part10, part_10_upper_chars)
  test_decode(iso_8859.Part11, part_11_upper_chars)
  test_decode(iso_8859.Part13, part_13_upper_chars)
  test_decode(iso_8859.Part14, part_14_upper_chars)
  test_decode(iso_8859.Part15, part_15_upper_chars)
  test_decode(iso_8859.Part16, part_16_upper_chars)
}

//
// The following lists are the upper 96 UTF-8 characters of the ISO 8859
// encodings, which is the only part that varies.
//

const part_1_upper_chars = [
  " ", "¡", "¢", "£", "¤", "¥", "¦", "§", "¨", "©", "ª", "«", "¬",
  "­", "®", "¯", "°", "±", "²", "³", "´", "µ", "¶", "·", "¸", "¹",
  "º", "»", "¼", "½", "¾", "¿", "À", "Á", "Â", "Ã", "Ä", "Å", "Æ",
  "Ç", "È", "É", "Ê", "Ë", "Ì", "Í", "Î", "Ï", "Ð", "Ñ", "Ò", "Ó",
  "Ô", "Õ", "Ö", "×", "Ø", "Ù", "Ú", "Û", "Ü", "Ý", "Þ", "ß", "à",
  "á", "â", "ã", "ä", "å", "æ", "ç", "è", "é", "ê", "ë", "ì", "í",
  "î", "ï", "ð", "ñ", "ò", "ó", "ô", "õ", "ö", "÷", "ø", "ù", "ú",
  "û", "ü", "ý", "þ", "ÿ",
]

const part_2_upper_chars = [
  " ", "Ą", "˘", "Ł", "¤", "Ľ", "Ś", "§", "¨", "Š", "Ş", "Ť", "Ź",
  "­", "Ž", "Ż", "°", "ą", "˛", "ł", "´", "ľ", "ś", "ˇ", "¸", "š",
  "ş", "ť", "ź", "˝", "ž", "ż", "Ŕ", "Á", "Â", "Ă", "Ä", "Ĺ", "Ć",
  "Ç", "Č", "É", "Ę", "Ë", "Ě", "Í", "Î", "Ď", "Đ", "Ń", "Ň", "Ó",
  "Ô", "Ő", "Ö", "×", "Ř", "Ů", "Ú", "Ű", "Ü", "Ý", "Ţ", "ß", "ŕ",
  "á", "â", "ă", "ä", "ĺ", "ć", "ç", "č", "é", "ę", "ë", "ě", "í",
  "î", "ď", "đ", "ń", "ň", "ó", "ô", "ő", "ö", "÷", "ř", "ů", "ú",
  "ű", "ü", "ý", "ţ", "˙",
]

const part_3_upper_chars = [
  " ", "Ħ", "˘", "£", "¤", "�", "Ĥ", "§", "¨", "İ", "Ş", "Ğ", "Ĵ",
  "­", "�", "Ż", "°", "ħ", "²", "³", "´", "µ", "ĥ", "·", "¸", "ı",
  "ş", "ğ", "ĵ", "½", "�", "ż", "À", "Á", "Â", "�", "Ä", "Ċ", "Ĉ",
  "Ç", "È", "É", "Ê", "Ë", "Ì", "Í", "Î", "Ï", "�", "Ñ", "Ò", "Ó",
  "Ô", "Ġ", "Ö", "×", "Ĝ", "Ù", "Ú", "Û", "Ü", "Ŭ", "Ŝ", "ß", "à",
  "á", "â", "�", "ä", "ċ", "ĉ", "ç", "è", "é", "ê", "ë", "ì", "í",
  "î", "ï", "�", "ñ", "ò", "ó", "ô", "ġ", "ö", "÷", "ĝ", "ù", "ú",
  "û", "ü", "ŭ", "ŝ", "˙",
]

const part_4_upper_chars = [
  " ", "Ą", "ĸ", "Ŗ", "¤", "Ĩ", "Ļ", "§", "¨", "Š", "Ē", "Ģ", "Ŧ",
  "­", "Ž", "¯", "°", "ą", "˛", "ŗ", "´", "ĩ", "ļ", "ˇ", "¸", "š",
  "ē", "ģ", "ŧ", "Ŋ", "ž", "ŋ", "Ā", "Á", "Â", "Ã", "Ä", "Å", "Æ",
  "Į", "Č", "É", "Ę", "Ë", "Ė", "Í", "Î", "Ī", "Đ", "Ņ", "Ō", "Ķ",
  "Ô", "Õ", "Ö", "×", "Ø", "Ų", "Ú", "Û", "Ü", "Ũ", "Ū", "ß", "ā",
  "á", "â", "ã", "ä", "å", "æ", "į", "č", "é", "ę", "ë", "ė", "í",
  "î", "ī", "đ", "ņ", "ō", "ķ", "ô", "õ", "ö", "÷", "ø", "ų", "ú",
  "û", "ü", "ũ", "ū", "˙",
]

const part_5_upper_chars = [
  " ", "Ё", "Ђ", "Ѓ", "Є", "Ѕ", "І", "Ї", "Ј", "Љ", "Њ", "Ћ", "Ќ",
  "­", "Ў", "Џ", "А", "Б", "В", "Г", "Д", "Е", "Ж", "З", "И", "Й",
  "К", "Л", "М", "Н", "О", "П", "Р", "С", "Т", "У", "Ф", "Х", "Ц",
  "Ч", "Ш", "Щ", "Ъ", "Ы", "Ь", "Э", "Ю", "Я", "а", "б", "в", "г",
  "д", "е", "ж", "з", "и", "й", "к", "л", "м", "н", "о", "п", "р",
  "с", "т", "у", "ф", "х", "ц", "ч", "ш", "щ", "ъ", "ы", "ь", "э",
  "ю", "я", "№", "ё", "ђ", "ѓ", "є", "ѕ", "і", "ї", "ј", "љ", "њ",
  "ћ", "ќ", "§", "ў", "џ",
]

const part_6_upper_chars = [
  " ", "�", "�", "�", "¤", "�", "�", "�", "�", "�", "�",
  "�", "،", "­", "�", "�", "�", "�", "�", "�", "�", "�",
  "�", "�", "�", "�", "�", "؛", "�", "�", "�", "؟", "�",
  "ء", "آ", "أ", "ؤ", "إ", "ئ", "ا", "ب", "ة", "ت", "ث", "ج", "ح",
  "خ", "د", "ذ", "ر", "ز", "س", "ش", "ص", "ض", "ط", "ظ", "ع", "غ",
  "�", "�", "�", "�", "�", "ـ", "ف", "ق", "ك", "ل", "م", "ن",
  "ه", "و", "ى", "ي", "ً", "ٌ", "ٍ", "َ", "ُ", "ِ", "ّ", "ْ", "�",
  "�", "�", "�", "�", "�", "�", "�", "�", "�", "�", "�",
  "�",
]

const part_7_upper_chars = [
  " ", "‘", "’", "£", "€", "₯", "¦", "§", "¨", "©", "ͺ", "«",
  "¬", "­", "�", "―", "°", "±", "²", "³", "΄", "΅", "Ά", "·", "Έ",
  "Ή", "Ί", "»", "Ό", "½", "Ύ", "Ώ", "ΐ", "Α", "Β", "Γ", "Δ", "Ε",
  "Ζ", "Η", "Θ", "Ι", "Κ", "Λ", "Μ", "Ν", "Ξ", "Ο", "Π", "Ρ", "�",
  "Σ", "Τ", "Υ", "Φ", "Χ", "Ψ", "Ω", "Ϊ", "Ϋ", "ά", "έ", "ή", "ί",
  "ΰ", "α", "β", "γ", "δ", "ε", "ζ", "η", "θ", "ι", "κ", "λ", "μ",
  "ν", "ξ", "ο", "π", "ρ", "ς", "σ", "τ", "υ", "φ", "χ", "ψ", "ω",
  "ϊ", "ϋ", "ό", "ύ", "ώ", "�",
]

const part_8_upper_chars = [
  " ", "�", "¢", "£", "¤", "¥", "¦", "§", "¨", "©", "×", "«", "¬",
  "­", "®", "¯", "°", "±", "²", "³", "´", "µ", "¶", "·", "¸", "¹",
  "÷", "»", "¼", "½", "¾", "�", "�", "�", "�", "�", "�", "�",
  "�", "�", "�", "�", "�", "�", "�", "�", "�", "�", "�",
  "�", "�", "�", "�", "�", "�", "�", "�", "�", "�", "�",
  "�", "�", "�", "‗", "א", "ב", "ג", "ד", "ה", "ו", "ז", "ח",
  "ט", "י", "ך", "כ", "ל", "ם", "מ", "ן", "נ", "ס", "ע", "ף", "פ",
  "ץ", "צ", "ק", "ר", "ש", "ת", "�", "�", "‎", "‏", "�",
]

const part_9_upper_chars = [
  " ", "¡", "¢", "£", "¤", "¥", "¦", "§", "¨", "©", "ª", "«", "¬",
  "­", "®", "¯", "°", "±", "²", "³", "´", "µ", "¶", "·", "¸", "¹",
  "º", "»", "¼", "½", "¾", "¿", "À", "Á", "Â", "Ã", "Ä", "Å", "Æ",
  "Ç", "È", "É", "Ê", "Ë", "Ì", "Í", "Î", "Ï", "Ğ", "Ñ", "Ò", "Ó",
  "Ô", "Õ", "Ö", "×", "Ø", "Ù", "Ú", "Û", "Ü", "İ", "Ş", "ß", "à",
  "á", "â", "ã", "ä", "å", "æ", "ç", "è", "é", "ê", "ë", "ì", "í",
  "î", "ï", "ğ", "ñ", "ò", "ó", "ô", "õ", "ö", "÷", "ø", "ù", "ú",
  "û", "ü", "ı", "ş", "ÿ",
]

const part_10_upper_chars = [
  " ", "Ą", "Ē", "Ģ", "Ī", "Ĩ", "Ķ", "§", "Ļ", "Đ", "Š", "Ŧ", "Ž",
  "­", "Ū", "Ŋ", "°", "ą", "ē", "ģ", "ī", "ĩ", "ķ", "·", "ļ", "đ",
  "š", "ŧ", "ž", "―", "ū", "ŋ", "Ā", "Á", "Â", "Ã", "Ä", "Å", "Æ",
  "Į", "Č", "É", "Ę", "Ë", "Ė", "Í", "Î", "Ï", "Ð", "Ņ", "Ō", "Ó",
  "Ô", "Õ", "Ö", "Ũ", "Ø", "Ų", "Ú", "Û", "Ü", "Ý", "Þ", "ß", "ā",
  "á", "â", "ã", "ä", "å", "æ", "į", "č", "é", "ę", "ë", "ė", "í",
  "î", "ï", "ð", "ņ", "ō", "ó", "ô", "õ", "ö", "ũ", "ø", "ų", "ú",
  "û", "ü", "ý", "þ", "ĸ",
]

const part_11_upper_chars = [
  " ", "ก", "ข", "ฃ", "ค", "ฅ", "ฆ", "ง", "จ", "ฉ", "ช",
  "ซ", "ฌ", "ญ", "ฎ", "ฏ", "ฐ", "ฑ", "ฒ", "ณ", "ด", "ต",
  "ถ", "ท", "ธ", "น", "บ", "ป", "ผ", "ฝ", "พ", "ฟ", "ภ",
  "ม", "ย", "ร", "ฤ", "ล", "ฦ", "ว", "ศ", "ษ", "ส", "ห",
  "ฬ", "อ", "ฮ", "ฯ", "ะ", "ั", "า", "ำ", "ิ", "ี", "ึ",
  "ื", "ุ", "ู", "ฺ", "�", "�", "�", "�", "฿", "เ", "แ",
  "โ", "ใ", "ไ", "ๅ", "ๆ", "็", "่", "้", "๊", "๋", "์",
  "ํ", "๎", "๏", "๐", "๑", "๒", "๓", "๔", "๕", "๖", "๗",
  "๘", "๙", "๚", "๛", "�", "�", "�", "�",
]

const part_13_upper_chars = [
  " ", "”", "¢", "£", "¤", "„", "¦", "§", "Ø", "©", "Ŗ", "«", "¬",
  "­", "®", "Æ", "°", "±", "²", "³", "“", "µ", "¶", "·", "ø", "¹",
  "ŗ", "»", "¼", "½", "¾", "æ", "Ą", "Į", "Ā", "Ć", "Ä", "Å", "Ę",
  "Ē", "Č", "É", "Ź", "Ė", "Ģ", "Ķ", "Ī", "Ļ", "Š", "Ń", "Ņ", "Ó",
  "Ō", "Õ", "Ö", "×", "Ų", "Ł", "Ś", "Ū", "Ü", "Ż", "Ž", "ß", "ą",
  "į", "ā", "ć", "ä", "å", "ę", "ē", "č", "é", "ź", "ė", "ģ", "ķ",
  "ī", "ļ", "š", "ń", "ņ", "ó", "ō", "õ", "ö", "÷", "ų", "ł", "ś",
  "ū", "ü", "ż", "ž", "’",
]

const part_14_upper_chars = [
  " ", "Ḃ", "ḃ", "£", "Ċ", "ċ", "Ḋ", "§", "Ẁ", "©", "Ẃ", "ḋ",
  "Ỳ", "­", "®", "Ÿ", "Ḟ", "ḟ", "Ġ", "ġ", "Ṁ", "ṁ", "¶", "Ṗ",
  "ẁ", "ṗ", "ẃ", "Ṡ", "ỳ", "Ẅ", "ẅ", "ṡ", "À", "Á", "Â", "Ã",
  "Ä", "Å", "Æ", "Ç", "È", "É", "Ê", "Ë", "Ì", "Í", "Î", "Ï", "Ŵ",
  "Ñ", "Ò", "Ó", "Ô", "Õ", "Ö", "Ṫ", "Ø", "Ù", "Ú", "Û", "Ü", "Ý",
  "Ŷ", "ß", "à", "á", "â", "ã", "ä", "å", "æ", "ç", "è", "é", "ê",
  "ë", "ì", "í", "î", "ï", "ŵ", "ñ", "ò", "ó", "ô", "õ", "ö", "ṫ",
  "ø", "ù", "ú", "û", "ü", "ý", "ŷ", "ÿ",
]

const part_15_upper_chars = [
  " ", "¡", "¢", "£", "€", "¥", "Š", "§", "š", "©", "ª", "«", "¬",
  "­", "®", "¯", "°", "±", "²", "³", "Ž", "µ", "¶", "·", "ž", "¹",
  "º", "»", "Œ", "œ", "Ÿ", "¿", "À", "Á", "Â", "Ã", "Ä", "Å", "Æ",
  "Ç", "È", "É", "Ê", "Ë", "Ì", "Í", "Î", "Ï", "Ð", "Ñ", "Ò", "Ó",
  "Ô", "Õ", "Ö", "×", "Ø", "Ù", "Ú", "Û", "Ü", "Ý", "Þ", "ß", "à",
  "á", "â", "ã", "ä", "å", "æ", "ç", "è", "é", "ê", "ë", "ì", "í",
  "î", "ï", "ð", "ñ", "ò", "ó", "ô", "õ", "ö", "÷", "ø", "ù", "ú",
  "û", "ü", "ý", "þ", "ÿ",
]

const part_16_upper_chars = [
  " ", "Ą", "ą", "Ł", "€", "„", "Š", "§", "š", "©", "Ș", "«", "Ź",
  "­", "ź", "Ż", "°", "±", "Č", "ł", "Ž", "”", "¶", "·", "ž", "č",
  "ș", "»", "Œ", "œ", "Ÿ", "ż", "À", "Á", "Â", "Ă", "Ä", "Ć", "Æ",
  "Ç", "È", "É", "Ê", "Ë", "Ì", "Í", "Î", "Ï", "Đ", "Ń", "Ò", "Ó",
  "Ô", "Ő", "Ö", "Ś", "Ű", "Ù", "Ú", "Û", "Ü", "Ę", "Ț", "ß", "à",
  "á", "â", "ă", "ä", "ć", "æ", "ç", "è", "é", "ê", "ë", "ì", "í",
  "î", "ï", "đ", "ń", "ò", "ó", "ô", "ő", "ö", "ś", "ű", "ù", "ú",
  "û", "ü", "ę", "ț", "ÿ",
]
